<!DOCTYPE ht<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>åœ˜é«”æ¥é§è»Šå ±åè¡¨</title>
  <link rel="icon" type="image/png" href="./icon.png">
<link rel="apple-touch-icon" href="./icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="./icon.png">

  <style>
    body {
      font-family: "Noto Sans TC", sans-serif;
      background: #f8fafc;
      margin: 0;
      padding: 20px;
    }

    h1 {
      text-align: center;
      margin-bottom: 20px;
      color: #334155;
    }

    .container {
      max-width: 600px;
      margin: auto;
      padding: 20px;
      background: #ffffff;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    }

    input, select, button {
      width: 100%;
      padding: 12px;
      margin-top: 8px;
      border-radius: 10px;
      border: 1px solid #cbd5e1;
      font-size: 16px;
    }

    button {
      background: #3b82f6;
      color: white;
      border: none;
      cursor: pointer;
      margin-top: 12px;
    }

    button:hover {
      background: #2563eb;
    }

    .card {
      background: #f1f5f9;
      border-radius: 12px;
      padding: 16px;
      margin-top: 14px;
      border-left: 6px solid #3b82f6;
    }

    .name-tag {
      display: inline-block;
      background: #3b82f6;
      padding: 6px 12px;
      border-radius: 20px;
      color: white;
      font-size: 15px;
      margin-right: 6px;
      margin-top: 6px;
    }

    .delete-btn {
      background: #ef4444;
      padding: 4px 10px;
      border-radius: 6px;
      margin-left: 8px;
      color: white;
      font-size: 13px;
      cursor: pointer;
    }

  </style>
</head>

<body>
  <h1>æ¥é§è»Šå ±åç³»çµ±</h1>

  <div class="container">
    <label>ä½ çš„åå­—</label>
    <input id="nameInput" placeholder="è«‹è¼¸å…¥å§“å" />

    <label>é¸æ“‡æ—¥æœŸ</label>
    <input id="dateInput" type="date" />

    <label>é¸æ“‡æ™‚é–“</label>
    <input id="timeInput" type="time" />

    <button onclick="addRecord()">åŠ å…¥</button>

    <hr style="margin: 20px 0;">

    <h2 style="color:#334155">ç›®å‰å ±åç‹€æ³</h2>
    <div id="listContainer"></div>
  </div>

  <script>
    const API =
      "https://script.google.com/macros/s/AKfycbxghtAVZ95YIiva-5bv39wPQJyY3qJJporuujwF6Kdb2G8T1RaZn5e0ISNo5e2VsPpdaA/exec";

    // ğŸš€ ä¸€è¼‰å…¥å°±æŠ“è³‡æ–™
    window.onload = loadData;

    function loadData() {
      fetch(API)
        .then((res) => res.json())
        .then((data) => {
          renderLists(data);
        })
        .catch(() => alert("è³‡æ–™è¼‰å…¥å¤±æ•—"));
    }

    async function addRecord() {
      const name = document.getElementById("nameInput").value.trim();
      const date = document.getElementById("dateInput").value;
      const time = document.getElementById("timeInput").value;

      if (!name || !date || !time) {
        alert("è«‹å¡«å¯«å®Œæ•´è³‡è¨Š");
        return;
      }

      const body = {
        action: "add",
        name,
        date,
        time,
      };

      await fetch(API, {
        method: "POST",
        body: JSON.stringify(body),
      });

      // â—åŠ å…¥å¾Œé¦¬ä¸Šæ›´æ–° UIï¼ˆä½ çš„åŸæœ¬ç‰ˆæœ¬å°±æ˜¯ç¼ºé€™å€‹ï¼‰
      loadData();
    }

    async function deleteRecord(id) {
      const body = {
        action: "delete",
        id,
      };

      await fetch(API, {
        method: "POST",
        body: JSON.stringify(body),
      });

      loadData();
    }

    // -----------------------------------------------------
    // â— renderListsï¼šé‡æ–°æ•´ç†å€å¡Šï¼ˆæ–°ç‰ˆå·²ä¿®æ­£ä¸¦ç¾åŒ–ï¼‰
    // -----------------------------------------------------
    function renderLists(data) {
      const container = document.getElementById("listContainer");
      container.innerHTML = "";

      data.forEach((group) => {
        const card = document.createElement("div");
        card.className = "card";

        // æ—¥æœŸ + æ™‚é–“æ¨™é¡Œ
        const title = document.createElement("h3");
        title.innerHTML = `ğŸ“… ${group.date}ã€€ğŸ•’ ${group.time}`;
        card.appendChild(title);

        // åå–®
        const list = document.createElement("div");
        group.names.forEach((item) => {
          const tag = document.createElement("div");
          tag.className = "name-tag";
          tag.innerHTML = `${item.name}
            <span class="delete-btn" onclick="deleteRecord('${item.id}')">
              åˆªé™¤
            </span>`;
          list.appendChild(tag);
        });

        card.appendChild(list);
        container.appendChild(card);
      });
    }
  </script>
</body>
</html>
